function resizeImage(){var i=img.naturalWidth,r=img.naturalHeight,u=$("#layout-portrait").attr("checked"),t,n;u?(n=$(window).width()-($("#sidebar").width()+90),t=$("#sidebar").height()-35,img.style.width=i>n?n+"px":"auto",img.style.height=r>t?t+"px":"auto"):(n=$(window).width()-50,img.style.width=i>n?n+"px":"auto",img.style.height="auto")}function toggleAutoScaleImageCheckbox(){var n=$("#autoscaleimage-checkbox").attr("checked");sendUsage("Setting - Auto Scale Image");n?(img.addEventListener("load",resizeImage),resizeImage()):(img.removeEventListener("load",resizeImage),img.style.width="auto",img.style.height="auto");typeof Storage!="undefined"&&localStorage.setItem("planttext_autoscaleimage",n)}function turnSnippetsOn(){user!=null&&editor.setOptions({enableSnippets:!0})}function turnSnippetsOff(){editor.setOptions({enableSnippets:!1})}function loginExtention(){$("#scripting-link").show();$("#plantumlserver-link").show();$("#email-link").show();$("#webhook-link").show();$("#chat-link").show();$("#intelligence-link").show();$("#diagram-manager-link").show();show_open_ai?$("#intelligence-link-div").show():$("#intelligence-link-div").hide();show_chat?$("#chat-link-div").show():$("#chat-link-div").hide();show_diagram_manager?$("#diagram-manager-link-div").show():$("#diagram-manager-link-div").hide();turnSnippetsOn();document.getElementById("settings-dialog-registered-group").disabled=!1;enableLoggedInHubs()}function logoutExtention(){$("#scripting-link").hide();$("#plantumlserver-link").hide();$("#email-link").hide();$("#webhook-link").hide();$("#chat-link").hide();$("#intelligence-link").hide();$("#diagram-manager-link").hide();show_open_ai?$("#intelligence-link-div").show():$("#intelligence-link-div").hide();show_chat?$("#chat-link-div").show():$("#chat-link-div").hide();show_diagram_manager?$("#diagram-manager-link-div").show():$("#diagram-manager-link-div").hide();turnSnippetsOff();document.getElementById("settings-dialog-registered-group").disabled=!0;disableLoggedInHubs()}function autoRefreshTimedCount(){try{refreshEditorDirect(!1)}catch(n){show_console&&console.log("Error refreshing diagram automatically.")}finally{auto_refresh_timer_is_on&&(auto_refresh_proxy=setTimeout(autoRefreshTimedCount,auto_refresh_diagram_rate))}}function autoRefreshStartCount(){auto_refresh_timer_is_on||(show_console&&console.log("Start refreshing diagram automatically."),auto_refresh_timer_is_on=1,autoRefreshTimedCount())}function autoRefreshStopCount(){clearTimeout(auto_refresh_proxy);auto_refresh_timer_is_on=0;show_console&&console.log("Stop refreshing diagram automatically.")}function toggleAutoRefreshCheckbox(){var n=$("#autorefresh-checkbox").attr("checked");sendUsage("Setting - Auto Refresh");n?autoRefreshStartCount():autoRefreshStopCount();typeof Storage!="undefined"&&localStorage.setItem("planttext_autorefresh",n)}function savePlantUmlServerFromButton(){var n,t;pauseButton("plantumlserversave-button","Paused",2e3);typeof Storage!="undefined"&&(n=document.getElementById("plantumlserver").value,n==""?localStorage.setItem("planttext_plantumlserver","default"):localStorage.setItem("planttext_plantumlserver",n));t="Your PlantUML Server has been saved to the local cache.";$("#fademessage").css("color","black").html(t).fadeIn(1).fadeOut(fade_message_time);$("#plantumlserver-dialog").dialog("close")}function defaultFromButton(){document.getElementById("plantumlserver").value="";$("#fademessage").css("color","black").html("The PlantUML server is now set to the defalt.").fadeIn(1).fadeOut(5e3)}function sendToEmailSubmitButton(){sendUsage("Send Email");pauseButton("sendtoemail-button","Paused",5e3);var t="",i=document.getElementById("description").value,r=encode64(deflate(unescape(encodeURIComponent(i)))),n=document.getElementById("plantumlserver").value;n=n.trim()==""?location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/api/plantuml/":n.endsWith("/")?n:n.concat("/");$.ajax({type:"POST",url:"api/send",timeout:5e3,headers:{Authorization:"Bearer "+user.accesstoken},dataType:"json",contentType:"application/json",processData:!1,data:JSON.stringify({Name:$("#sendtoemail-name").val(),PlantUmlServer:n,ImageType:$("#sendtoemail-imagetype").val(),Diagram:r}),success:function(n){n&&(t=n.message,n.success&&$("#fademessage").css("color","black").html(t).fadeIn(1).fadeOut(fade_message_time),$("#sendtoemail-dialog").dialog("close"))},error:function(){console.log("An error occured while sending diagram via email. Please contact admin@planttext.com.")}})}function getWebhookData(){var f=document.getElementById("description").value,r=encode64(deflate(unescape(encodeURIComponent(f)))),n=document.getElementById("plantumlserver").value,t,i,u;n=n.trim()==""?location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/api/plantuml/":n.endsWith("/")?n:n.concat("/");t="";i=$("#webhook-imagetype").val();i=="png"?t=n+"img/"+r:i=="svg"?t=n+"svg/"+r:i=="txt"?t=n+"txt/"+r:i=="edit"&&(t=n+"/?text="+r);u={Name:$("#webhook-name").val(),UrlType:i,WebHook:$("#webhook-hook").val(),DiagramUrl:t};$("#webhook-request").val(JSON.stringify(u,undefined,6))}function webhookUrlSave(){typeof Storage!="undefined"&&(localStorage.setItem("planttext_webhook",document.getElementById("webhook-hook").value),localStorage.setItem("planttext_webhooktype",document.getElementById("webhook-imagetype").value));$("#fademessage").css("color","black").html("Your Webhook URL has been saved to the local cache.").fadeIn(1).fadeOut(fade_message_time)}function webhookSubmitButton(){sendUsage("Send Webhook");pauseButton("webhook-button","Paused",5e3);webhookUrlSave();var u=document.getElementById("description").value,i=encode64(deflate(unescape(encodeURIComponent(u)))),f=$("#webhook-name").val(),n=$("#webhook-imagetype").val(),e=$("#webhook-hook").val(),r="",t=document.getElementById("plantumlserver").value;r=n=="edit"?location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/?text="+i:t.trim()==""?location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/api/plantuml/"+n+"/"+i:t.endsWith("/")?t:t.concat("/")+n+"/"+i;$.ajax({type:"POST",url:"api/webhook",timeout:5e4,headers:{Authorization:"Bearer "+user.accesstoken},dataType:"json",contentType:"application/json",processData:!1,data:JSON.stringify({Name:f,UrlType:n,WebHook:e,DiagramUrl:r}),success:function(n){n?($("#webhook-response").val(JSON.stringify(n,undefined,6)),$("#fademessage").css("color","black").html(n).fadeIn(1).fadeOut(fade_message_time)):$("#webhook-response").val(n)},error:function(){console.log("An error occured while sending diagram via webhook. Please contact admin@planttext.com.")}})}function LoadSampleCategories(){$.ajax({type:"GET",url:"api/samples/categories",timeout:5e3,success:function(n){for(var r,i=$("#samples-categories"),t=0;t<n.length;t++)r=$(document.createElement("option")).attr("value",n[t].category).text(n[t].category).appendTo(i)},error:function(){console.log("An error occured while loading all samples. Please contact admin@planttext.com.")}})}function submitSampleSelectedButton(){var n=document.getElementById("samples-response"),t=n.value,i=n.selectionStart,r=n.selectionEnd;editor.session.insert(editor.getCursorPosition(),t.substring(i,r));refreshFromSamples(editor.getValue())}function submitSampleToEditorButton(){var n=!0,t;warn_about_samples&&(n=confirm('This will replace the PlantUML in the editor window. This is the last warning. Press "Ok" to coninue or "Cancel" to abort.',"Samples"),warn_about_samples=!1);n&&(t=$("#samples-response").val(),refreshFromSamples(t))}function LoadClientSettings(){$.ajax({type:"GET",url:"api/settings","async":!1,timeout:5e3,success:function(n){n&&(show_console=n.showConsole,send_usage_info=n.sendUsageInfo,news_version=n.newsVersion,fade_message_time=n.fadeMessageTime,show_open_ai=n.showOpenAi,show_chat=n.showChat,show_diagram_manager=n.showDiagramManager,auto_refresh_diagram_rate=n.autoRefreshDiagramRate,$("#autorefresh-span").attr("title","This saves and refreshes the diagram every "+auto_refresh_diagram_rate/1e3+" seconds."))},error:function(){console.log("An error occured while loading all samples. Please contact admin@planttext.com.")}})}function settingsDefaultButton(){sendUsage("Setting - Default");pauseButton("settingsdefault-button","Paused",2e3);$("#layout-portrait").attr("checked","checked");portrait();$("#theme option[value='textmate']").attr("selected",!0);editor.setTheme("ace/theme/textmate");$("#keybinding option[value='ace']").attr("selected",!0);editor.setKeyboardHandler("ace/keyboard/ace");$("#fontsize option[value='12']").attr("selected",!0);editor.setFontSize("12px");$("#usesofttabs-checkbox").attr("checked","checked");editor.session.setUseSoftTabs(!0);$("#tabsize-dropdown option[value='2']").attr("selected",!0);editor.session.setTabSize(2);$("#invisibles").removeAttr("checked");editor.setShowInvisibles(!1);$("#indentguide").attr("checked","checked");editor.setDisplayIndentGuides(!0);$("#highlightactiveline-checkbox").attr("checked","checked");editor.setHighlightActiveLine(!0);$("#showprintmargin-checkbox").attr("checked","checked");editor.setShowPrintMargin(!0);$("#showscratch-checkbox").removeAttr("checked");$('textarea[name="scratch-textarea"]').hide();$("#scratchblock").css("border","0px solid");$("#usewrapmode-checkbox").removeAttr("checked");editor.session.setUseWrapMode(!1);$("#syntaxhighlighting-checkbox").attr("checked","checked");editor.getSession().setMode("ace/mode/diagram");$("#liveautocompletion-checkbox").attr("checked","checked");editor.setOptions({enableLiveAutocompletion:!0});$("#snippet-checkbox").attr("checked","checked");user!=null&&editor.setOptions({enableSnippets:!0});$("#fademessage").css("color","black").html("Your settings have been set to defaults.").fadeIn(1).fadeOut(5e3)}function toggleVisibles(){sendUsage("Setting - Invisibles");editor.getShowInvisibles()==!1?(editor.setShowInvisibles(!0),typeof Storage!="undefined"&&localStorage.setItem("planttext_invisibles",document.getElementById("invisibles").checked)):(editor.setShowInvisibles(!1),typeof Storage!="undefined"&&localStorage.setItem("planttext_invisibles",document.getElementById("invisibles").checked))}function toggleIndentGuide(){sendUsage("Setting - Indent Guides");editor.getDisplayIndentGuides()==!1?(editor.setDisplayIndentGuides(!0),typeof Storage!="undefined"&&localStorage.setItem("planttext_indentguide",document.getElementById("indentguide").checked)):(editor.setDisplayIndentGuides(!1),typeof Storage!="undefined"&&localStorage.setItem("planttext_indentguide",document.getElementById("indentguide").checked))}function toggleShowScratchCheckbox(){sendUsage("Setting - Scratch Area");$('textarea[name="scratch-textarea"]').is(":hidden")?($('textarea[name="scratch-textarea"]').show(),$("#scratchblock").css("border","1px solid"),$("#scratchblock").css("border-color","lightgrey"),typeof Storage!="undefined"&&localStorage.setItem("planttext_showscratch",document.getElementById("showscratch-checkbox").checked)):($('textarea[name="scratch-textarea"]').hide(),$("#scratchblock").css("border","0px solid"),typeof Storage!="undefined"&&localStorage.setItem("planttext_showscratch",document.getElementById("showscratch-checkbox").checked))}function toggleSyntaxHighlightingCheckbox(){sendUsage("Setting - SyntaxHighlighting");var n=$("#syntaxhighlighting-checkbox").attr("checked"),t=$("#mode").val();n?editor.getSession().setMode("ace/mode/"+t):editor.getSession().setMode("ace/mode/text");typeof Storage!="undefined"&&localStorage.setItem("planttext_syntaxhighlight",n)}function toggleLiveAutocompletionCheckbox(){sendUsage("Setting - Live Autocompletion");var n=$("#liveautocompletion-checkbox").attr("checked");n?editor.setOptions({enableLiveAutocompletion:!0}):editor.setOptions({enableLiveAutocompletion:!1});typeof Storage!="undefined"&&localStorage.setItem("planttext_liveautocompletion",n)}function toggleSnippetCheckbox(){sendUsage("Setting - Snippets");var n=$("#snippet-checkbox").attr("checked");n?(editor.setOptions({enableSnippets:!0}),$("#snippet-types").removeAttr("disabled")):(editor.setOptions({enableSnippets:!1}),$("#snippet-types").attr("disabled","disabled"));typeof Storage!="undefined"&&localStorage.setItem("planttext_snippet",n)}function popupAfterChildClose(){popout_diagram_window!=null&&popout_diagram_window.location!="about:blank"&&(portrait(),$("#content").show(),$("#popoutdiagramwindow-checkbox").removeAttr("checked"))}function togglePopoutdiagramwindowCheckbox(){sendUsage("Setting - Popout Window");var n=$("#popoutdiagramwindow-checkbox").attr("checked");if(n){let n=`scrollbars=yes,resizable=yes,status=no,location=no,toolbar=no,menubar=no,width=500,height=500,left=100,top=100`;popout_diagram_window=window.open("/popout.html","popoutdiagramwindow",n);popout_diagram_window.onunload=popupAfterChildClose;fullScreen();$("#content").hide();setTimeout(function(){refreshEditorDirect(!0)},1e3)}else popout_diagram_window!=null&&(popout_diagram_window.close(),popout_diagram_window=null,portrait(),$("#content").show())}function toggleDarkbackgroundCheckbox(){sendUsage("Setting - Dark Background");var n=$("#darkbackground-checkbox").attr("checked");n?($("body").css({"background-color":"black"}),$("#body").css({"background-color":"black"}),$("#header-left").css({"background-color":"black"}),$("#header-right").css({"background-color":"black"}),$("#main").css({"background-color":"black"}),$("#sidebar").css({"background-color":"black"}),$("#content").css({"background-color":"black"}),$("#scratchblock").css({"background-color":"black"}),$("#menu").css({"background-color":"black"}),$("#menu-left").css({"background-color":"black"}),$("#menu-right").css({"background-color":"black"}),$("#footer").css({"background-color":"black"})):($("body").css({"background-color":"white"}),$("#body").css({"background-color":"white"}),$("#header-left").css({"background-color":"white"}),$("#header-right").css({"background-color":"white"}),$("#main").css({"background-color":"white"}),$("#sidebar").css({"background-color":"white"}),$("#content").css({"background-color":"white"}),$("#scratchblock").css({"background-color":"white"}),$("#menu").css({"background-color":"white"}),$("#menu-left").css({"background-color":"white"}),$("#menu-right").css({"background-color":"white"}),$("#footer").css({"background-color":"white"}))}function toggleUseSoftTabsCheckbox(){sendUsage("Setting - Soft Tabs");editor.session.getUseSoftTabs()==!1?(editor.session.setUseSoftTabs(!0),$("#tabsize-dropdown").removeAttr("disabled"),typeof Storage!="undefined"&&localStorage.setItem("planttext_usesofttabs",document.getElementById("usesofttabs-checkbox").checked)):(editor.session.setUseSoftTabs(!1),$("#tabsize-dropdown").attr("disabled","disabled"),typeof Storage!="undefined"&&localStorage.setItem("planttext_usesofttabs",document.getElementById("usesofttabs-checkbox").checked))}function toggleUseWrapModeCheckbox(){sendUsage("Setting - Wrap Mode");editor.session.getUseWrapMode()==!1?(editor.session.setUseWrapMode(!0),typeof Storage!="undefined"&&localStorage.setItem("planttext_usewrapmode",document.getElementById("usewrapmode-checkbox").checked)):(editor.session.setUseWrapMode(!1),typeof Storage!="undefined"&&localStorage.setItem("planttext_usewrapmode",document.getElementById("usewrapmode-checkbox").checked))}function toggleHighlightActiveLineCheckbox(){sendUsage("Setting - Highlight Active Line");editor.getHighlightActiveLine()==!1?(editor.setHighlightActiveLine(!0),typeof Storage!="undefined"&&localStorage.setItem("planttext_highlightactiveline",document.getElementById("highlightactiveline-checkbox").checked)):(editor.setHighlightActiveLine(!1),typeof Storage!="undefined"&&localStorage.setItem("planttext_highlightactiveline",document.getElementById("highlightactiveline-checkbox").checked))}function toggleShowPrintMarginCheckbox(){sendUsage("Setting - Show Print Margin");editor.getShowPrintMargin()==!1?(editor.setShowPrintMargin(!0),typeof Storage!="undefined"&&localStorage.setItem("planttext_showprintmargin",document.getElementById("showprintmargin-checkbox").checked)):(editor.setShowPrintMargin(!1),typeof Storage!="undefined"&&localStorage.setItem("planttext_showprintmargin",document.getElementById("showprintmargin-checkbox").checked))}function changeHighlightingMode(n){$("#mode").val(n);editor.getSession().setMode("ace/mode/"+n)}function checkLanguageType(n){var t=n.toLowerCase();t.includes("@startjson")?changeHighlightingMode("json"):t.includes("@startyaml")?changeHighlightingMode("yaml"):changeHighlightingMode("diagram")}function checkDiagramTheme(n){var f=n.toLowerCase(),o=$("#diagram-themes").val(),u=!1,e=-1,t=f.split("\n"),r="";for(i=0;i<t.length;i++)if(t[i].includes("!theme")){u=!0;e=i;r=t[i].trim().substring(7);break}u?r.trim()=="_none_"||$("#diagram-themes").val(r.trim()):$("#diagram-themes").val("_none_")}function refreshEditorDirect(n){var t=document.getElementById("description").value,i,r;typeof Storage!="undefined"&&(i=localStorage.getItem("planttext_default"),r=localStorage.getItem(i),(i!=null&&i!=""&&t!=r||n)&&(localStorage.setItem(i,t),checkDiagramTheme(t),checkLanguageType(t),show_console&&console.log("Saving and refreshing diagram..."),popout_diagram_window===null?compress(t):compressPopup(t,popout_diagram_window),$("#fademessage").css("color","black").html("The diagram is refreshing and your PlantUML has been saved to your computer's local storage.").fadeIn(1).fadeOut(fade_message_time)))}function refreshFromButton(){sendUsage("Refresh Diagram");pauseButton("refreshbutton","Paused",2e3);pauseButton("refreshbutton2","Paused",2e3);refreshEditorDirect(!0)}function refreshFromSamples(n){editor.getSession().setValue(n);refreshEditorDirect(!1)}function urlFromPlantUML(n,t,i){sendUsage("Create Link");pauseButton("scriptingbutton","Paused",5e3);var r=document.getElementById(n).value,u=document.getElementById(t).value;$.ajax({type:"POST",url:"api/scripting",timeout:5e3,dataType:"text",contentType:"text/plain;charset=UTF-8",processData:!1,data:u,success:function(n){var u="",t=document.getElementById("plantumlserver").value,f;t.trim()==""?(t=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/api/plantuml/",u=t+r+"/"+n):(t=t.endsWith("/")?t:t.concat("/"),u=t+r+"/"+n);u=t+r+"/"+n;document.getElementById(i).value=u;f="Converting PlantUML to link.";$("#fademessage").css("color","black").html(f).fadeIn(1).fadeOut(fade_message_time)},error:function(){console.log("An error occured while creating a link for diagram. Please contact admin@planttext.com.")}})}function resizeBrowser(){window_width=$(window).width();window_height=$(window).height();var n=$("#layout-landscape").attr("checked");n?landscape():portrait()}function resizeEditor(){var n=$("#sidebar").width(),t=$("#sidebar").height();$("#editor").width(n-10);$("#editor").height(t-55);$("#scratch").height($(window).height()-sidebar_portrait_h_mod-10);$("#scratch").width(sidebar_portrait_w);editor.resize()}function openSamplesDialog(){$("#samples-dialog").dialog("isOpen")?$("#samples-dialog").dialog("close"):(closeWindows(),$("#samples-dialog").dialog("open"))}function openSettingsDialog(){$("#settings-dialog").dialog("isOpen")?$("#settings-dialog").dialog("close"):(closeWindows(),$("#settings-dialog").dialog("open"))}function openHelpDialog(){$("#help-dialog").dialog("isOpen")?$("#help-dialog").dialog("close"):(closeWindows(),sendUsage("Open Help Dialog"),$.ajax({type:"GET",url:"api/data/open/html-help",timeout:5e3,success:function(n){$("#helpitem").html(n);$("#help-dialog").dialog("open");$("#help-dialog").scrollTop("0")},error:function(){console.log("An error occured while opening news dialog.")}}))}function openScriptingDialog(){$("#scripting-dialog").dialog("isOpen")?$("#scripting-dialog").dialog("close"):(closeWindows(),$("#scripting-dialog").dialog("open"))}function openPlantUmlServerDialog(){$("#plantumlserver-dialog").dialog("isOpen")?$("#plantumlserver-dialog").dialog("close"):(closeWindows(),$("#plantumlserver-dialog").dialog("open"))}function openSendToEmailDialog(){$("#sendtoemail-dialog").dialog("isOpen")?$("#sendtoemail-dialog").dialog("close"):(closeWindows(),$("#sendtoemail-dialog").dialog("open"))}function openWebhookDialog(){var n,t;$("#webhook-dialog").dialog("isOpen")?$("#webhook-dialog").dialog("close"):(closeWindows(),$("#webhook-dialog").dialog("open"),typeof Storage!="undefined"&&(n=localStorage.getItem("planttext_webhook"),$("#webhook-hook").val(n),t=localStorage.getItem("planttext_webhooktype"),$("#webhook-imagetype option[value='"+t+"']").attr("selected",!0)),getWebhookData(),$("#webhook-hook").keyup(function(){getWebhookData()}),$("#webhook-imagetype").change(function(){getWebhookData()}),$("#webhook-name").keyup(function(){getWebhookData()}))}function openIntelligenceDialog(){$("#intelligence-dialog").dialog("isOpen")?$("#intelligence-dialog").dialog("close"):(closeWindows(),$("#intelligence-dialog").dialog("open"))}function openChatDialog(){$("#chat-dialog").dialog("isOpen")?$("#chat-dialog").dialog("close"):(closeWindows(),$("#chat-dialog").dialog("open"))}function openDiagramManagerDialog(){$("#diagram-manager-dialog").dialog("isOpen")?$("#diagram-manager-dialog").dialog("close"):(closeWindows(),$("#diagram-manager-dialog").dialog("open"))}function clearMessagesExtension(){$("#sendtoemail-message").text("");$("#webhook-message").text("");$("#file-menu-new-message").text("");$("#file-menu-open-message").text("");$("#file-menu-saveas-message").text("")}function closeWindowsExtension(){$("#samples-dialog").dialog("close");$("#settings-dialog").dialog("close");$("#help-dialog").dialog("close");$("#scripting-dialog").dialog("close");$("#plantumlserver-dialog").dialog("close");$("#sendtoemail-dialog").dialog("close");$("#webhook-dialog").dialog("close");$("#intelligence-dialog").dialog("close");$("#chat-dialog").dialog("close");$("#diagram-manager-dialog").dialog("close")}function openImportExportFiles(){$("#file-menu-xport-dialog").dialog("open")}function fileNameOutput(){var n=localStorage.getItem("planttext_default");$("#file-name-output").text(n.substring(18))}function openFileMenuNew(){$("#file-menu-new-dialog").dialog("open")}function submitFileMenuNew(){var u,f,r;sendUsage("Local Files - New");var t="",n=$("#file-menu-new-name").val().trim(),e=!1;for(i=0;i<window.localStorage.length;i++)if(u=window.localStorage.key(i),u.substring(0,18)==="planttext_diagram:"&&u.substring(18).trim()==n.trim()){e=!0;break}e?(t="This file name is already in use. Please try another name.",$("#file-menu-new-message").text(t)):n.trim()==""||n.length>=40?(t="Please enter a name that is fewer than 40 characters.",$("#file-menu-new-message").text(t)):n!=null&&(f="@startuml\r\rtitle Empty Diagram\r\r@enduml",r="planttext_diagram:"+n,localStorage.setItem("planttext_default",r),localStorage.setItem(r,f),fileNameOutput(r),refreshFromSamples(f),$("#file-menu-new-dialog").dialog("close"))}function submitFileMenuNewCancel(){$("#file-menu-new-dialog").dialog("close")}function openFileMenuOpen(){$("#file-menu-open-dialog").dialog("open")}function submitFileMenuOpen(){var i;sendUsage("Local Files - Open");var t="",n=$("#file-menu-open-list").val(),r=localStorage.getItem("planttext_default");n==null?(t="Please select a file to open or close this window.",$("#file-menu-open-message").text(t)):r==n?(t="You have selected the same file that is currently open.",$("#file-menu-open-message").text(t)):(i=localStorage.getItem(n),localStorage.setItem("planttext_default",n),localStorage.setItem(n,i),fileNameOutput(n),refreshFromSamples(i),$("#file-menu-open-dialog").dialog("close"))}function submitFileMenuOpenLoad(){var n,t;for($("#file-menu-open-list").html(""),n=[],i=0;i<window.localStorage.length;i++)t=localStorage.key(i),t.substring(0,18)==="planttext_diagram:"&&n.push(t);n.sort();for(let t=0;t<n.length;t++)$("#file-menu-open-list").append('<option value="'+n[t]+'">'+n[t].substring(18,n[t].length)+"<\/option>")}function submitFileMenuOpenCancel(){$("#file-menu-open-dialog").dialog("close")}function saveDiagramDirect(){var t="",n=localStorage.getItem("planttext_default"),i,r;n==""?(t="No file is currently loaded. Please use New or Save As to create a new file.",$("#fademessage").css("color","red").html(t).fadeIn(1).fadeOut(fade_message_time)):typeof Storage!="undefined"?(i=$("#description").val(),r=localStorage.getItem(n),n!=null&&n!=""&&i!=r&&(show_console&&console.log("Saving diagram..."),localStorage.setItem(n,i),fadeMsge="The diagram has been saved to your computer's local storage.",$("#fademessage").css("color","black").html(fadeMsge).fadeIn(1).fadeOut(fade_message_time))):(t="It appears you do not have a local storage capable browser or configuration. Please resolve before trying to use this application",$("#fademessage").css("color","red").html(t).fadeIn(1).fadeOut(fade_message_time))}function submitFileMenuSave(){sendUsage("Local Files - Save");saveDiagramDirect()}function openFileMenuSaveas(){$("#file-menu-saveas-dialog").dialog("open")}function submitFileMenuSaveas(){var u,f,r;sendUsage("Local Files - SaveAs");var t="",n=$("#file-menu-saveas-name").val().trim(),e=!1;for(i=0;i<window.localStorage.length;i++)if(u=window.localStorage.key(i),u.substring(0,18)==="planttext_diagram:"&&u.substring(18).trim()==n.trim()){e=!0;break}e?(t="This file name is already in use. Please try another name.",$("#file-menu-saveas-message").text(t)):n.trim()==""||n.length>=40?(t="Please enter a name that is fewer than 40 characters.",$("#file-menu-saveas-message").text(t)):n!=null&&(f=document.getElementById("description").value,r="planttext_diagram:"+n,localStorage.setItem("planttext_default",r),localStorage.setItem(r,f),fileNameOutput(r),refreshFromSamples(f),$("#file-menu-saveas-dialog").dialog("close"))}function submitFileMenuSaveasCancel(){$("#file-menu-saveas-dialog").dialog("close")}function submitFileMenuDelete(){var n,t;sendUsage("Local Files - Delete");typeof Storage!="undefined"&&(n=localStorage.getItem("planttext_default"),n==""?alert("No file is currently loaded. Please open the file you wish to delete."):(t=!0,t=confirm('This will delete the PlantUML file. Press "Ok" to coninue or "Cancel" to abort.',"Delete File"),t&&(localStorage.removeItem(n),localStorage.setItem("planttext_default",""),refreshFromSamples("@startuml\r\rtitle Empty Diagram\r\r@enduml"),$("#file-name-output").text(""))))}function openFileMenu(){document.getElementById("file-menu-list").classList.toggle("show")}function unDock(){var n=$(window).width()-($("#sidebar").width()+50);$("#sidebar").draggable();$("#sidebar").css({top:10});$("#sidebar").css({left:+n});$("#content").offset(sidebar_offset);resizeEditor();$("#fademessage").css("color","black").html("The editor is now in drag mode. You can move it around to any position on the screen.").fadeIn(1).fadeOut(fade_message_time)}function doDock(){$("#sidebar").draggable("destroy");$("#sidebar").width(sidebar_portrait_w);$("#sidebar").height($(window).height()-sidebar_portrait_h_mod);$("#sidebar").offset(sidebar_offset);$("#sidebar").css({float:"left"});resizeEditor();$("#content").css({float:"left"});$("#content").offset(diagram_offset);$("#fademessage").css("color","black").html("The editor is now in dock mode. It will always be docked to the upper left and the diagram will to the right or below it.").fadeIn(1).fadeOut(fade_message_time)}function clickPortrait(){sendUsage("Setting - Layout Portrait");portrait();typeof Storage!="undefined"&&localStorage.setItem("planttext_layout",$("input[name='layout']:checked").val())}function clickLandscape(){sendUsage("Setting - Layout Landscape");landscape();typeof Storage!="undefined"&&localStorage.setItem("planttext_layout",$("input[name='layout']:checked").val())}function portrait(){$("#sidebar").height($(window).height()-sidebar_portrait_h_mod);$("#sidebar").width(sidebar_portrait_w);resizeEditor()}function landscape(){$("#sidebar").height($(window).height()/sidebar_landscape_h_mod);$("#sidebar").width($(window).width()-sidebar_landscape_w_mod);resizeEditor()}function fullScreen(){$("#sidebar").height($(window).height()-sidebar_portrait_h_mod);$("#sidebar").width($(window).width()-sidebar_landscape_w_mod);resizeEditor()}function submitFileMenuXportImport(){var n;sendUsage("Local Files - Import");var i=document.getElementById("file-menu-xport-import"),t=i.files[0];return t.type.match(/text.*/)?(n=new FileReader,n.onload=function(){editor.getSession().setValue(n.result);refreshEditorDirect(!0)},n.readAsText(t)):alert("File not supported!"),!1}function submitFileMenuXportExport(){return sendUsage("Local Files - Export"),Download.save(editor.getSession().getValue(),"plantuml_export.txt"),!1}var show_console=!1,send_usage_info=!1,news_version=1,fade_message_time=4e3,show_open_ai=!1,show_chat=!1,show_diagram_manager=!1,popout_diagram_window=null,sidebar_portrait_w=320,sidebar_portrait_h_mod=80,sidebar_landscape_w_mod=75,sidebar_landscape_h_mod=2.5,sidebar_offset={top:101,left:13},diagram_offset={top:101,left:535},warn_about_samples=!0,window_width,window_height,editor=ace.edit("editor"),auto_refresh_proxy,auto_refresh_timer_is_on=0,auto_refresh_diagram_rate=5e3,textarea=$('textarea[name="description"]').hide(),img,snippetManager,snippets,Download;editor.getSession().setValue(textarea.val());editor.getSession().on("change",function(){textarea.val(editor.getSession().getValue())});editor.getSession().setMode("ace/mode/diagram");editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!1});img=document.getElementById("im");snippetManager=ace.require("ace/snippets").snippetManager;snippets=null;document.getElementById("snippet-types").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Snippet Type");n=="none"?snippets!=null&&snippetManager.unregister(snippets):$.ajax({type:"GET",url:"api/data/"+n,timeout:5e3,headers:{Authorization:"Bearer "+user.accesstoken},dataType:"text",contentType:"application/json",processData:!1,success:function(n){var t;n==""?(t="Snippets do not exist for this type yet.",$("#fademessage").css("color","red").html(t).fadeIn(1).fadeOut(fade_message_time)):user!=null&&(snippets!=null&&snippetManager.unregister(snippets),snippets=snippetManager.parseSnippetFile(n),snippetManager.register(snippets),t="Snippets are turned on.",$("#fademessage").css("color","black").html(t).fadeIn(1).fadeOut(fade_message_time))},error:function(){console.log("An error occured. Please contact admin@planttext.com.")}})};document.getElementById("samples-categories").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Load Sample Category");n!="default"&&$.ajax({type:"GET",url:"api/samples/bycategory/"+n,timeout:5e3,success:function(n){var i=$("#samples-items"),t,r;for(i.find("option").not(":first").remove(),t=0;t<n.length;t++)r=$(document.createElement("option")).attr("value",n[t].id).text(n[t].name).appendTo(i)},error:function(){console.log("An error occured while loading a single sample. Please contact admin@planttext.com.")}})};document.getElementById("samples-items").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Load Sample Item");n!="default"&&$.ajax({type:"GET",url:"api/samples/"+n,timeout:5e3,success:function(n){$("#samples-dialog").dialog("isOpen")||$("#samples-dialog").dialog("open");$("#samples-response").val(n.content);compressSample(n.content)},error:function(){console.log("An error occured while loading a single sample. Please contact admin@planttext.com.")}})};document.getElementById("theme").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Editor Theme");editor.setTheme("ace/theme/"+n);typeof Storage!="undefined"&&localStorage.setItem("planttext_theme",n)};document.getElementById("diagram-themes").onchange=function(){var t=this.options[this.selectedIndex].value,s,h,r;sendUsage("Setting - Diagram Theme");var c=document.getElementById("description").value,u=!1,e=-1,o=!1,f=-1,n=c.split("\n");for(i=0;i<n.length;i++)if(s=n[i].includes("@start"),s&&(u=!0,e=i),h=n[i].includes("!theme"),h){o=!0;f=i;break}u&&o?(n.splice(f,1),t!="_none_"&&n.splice(f,0,"!theme "+t),r=n.join("\n"),editor.getSession().setValue(r),refreshEditorDirect(!0)):u?(t!="_none_"&&n.splice(e+1,0,"!theme "+t),r=n.join("\n"),editor.getSession().setValue(r),refreshEditorDirect(!0)):$("#fademessage").css("color","red").html("There must be a '@startuml' tag at the top of the diagram in order to use this feature.").fadeIn(1).fadeOut(fade_message_time)};document.getElementById("mode").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Change Highlighting Mode");editor.getSession().setMode("ace/mode/"+n)};document.getElementById("fontsize").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Fontsize");editor.setFontSize(n+"px");editor.resize();typeof Storage!="undefined"&&localStorage.setItem("planttext_fontsize",n)};document.getElementById("tabsize-dropdown").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Tab Size");editor.session.setTabSize(n);editor.resize();typeof Storage!="undefined"&&localStorage.setItem("planttext_tabsize",n)};document.getElementById("keybinding").onchange=function(){var n=this.options[this.selectedIndex].value;sendUsage("Setting - Keybinding");editor.setKeyboardHandler("ace/keyboard/"+n);typeof Storage!="undefined"&&localStorage.setItem("planttext_keybinding",n)};window.onclick=function(n){var i,t,r;if(!n.target.matches("#file-menu-button"))for(i=document.getElementsByClassName("file-menu-dropdown-content"),t=0;t<i.length;t++)r=i[t],r.classList.contains("show")&&r.classList.remove("show")};Download={click:function(n){var t=document.createEvent("MouseEvents");return t.initMouseEvent("click",!0,!1,self,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(t)},encode:function(n){return"data:application/octet-stream;base64,"+btoa(n)},link:function(n,t){var i=document.createElement("a");return i.download=t||self.location.pathname.slice(self.location.pathname.lastIndexOf("/")+1),i.href=n||self.location.href,i}};Download.save=function(n,t){this.click(this.link(this.encode(n),t))};$(window).resize(resizeBrowser);resizeBrowser();$(document).keydown(function(n){n.keyCode==13&&n.altKey&&$("#refreshbutton").click()});$(document).ready(function(){var r,f,v,n,y,p,w,b,t,d,g,nt,tt,it,rt,ut,ft,et,e,ot,st,o;LoadClientSettings();$("#fademessage").css("color","black").html("Loading").fadeIn(1).fadeOut(fade_message_time);onDocumentLoadCommon();$("#scripting-link").hide();$("#plantumlserver-link").hide();$("#email-link").hide();$("#webhook-link").hide();$("#chat-link").hide();$("#intelligence-link").hide();$("#diagram-manager-link").hide();var s=!1,h="",c=!1,i="",l=!1,a="",u=param();for(k in u)entify(k)=="text"&&(s=!0,h=entify(u[k][0])),entify(k)=="window"&&(c=!0,i=entify(u[k][0])),entify(k)=="token"&&(l=!0,a=entify(u[k][0]));$("#sidebar").resizable({resize:function(){resizeEditor()},minHeight:350,minWidth:320});$("#news-dialog").dialog({title:"News",width:600,height:400,autoOpen:!1,modal:!1,resizable:!0,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#login-dialog").dialog({title:"Login",width:275,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#register-dialog").dialog({title:"Register",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#forgot-dialog").dialog({title:"Forgot Password",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#reset-dialog").dialog({title:"Reset Password",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#identity-dialog").dialog({title:"Edit Profile",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){$("#identity-email").text(user.email);$("#identity-firstname").val(user.firstname);$("#identity-lastname").val(user.lastname);$("#identity-username").val(user.email);$("#identity-password").val("");$("#identity-password-new1").val("");$("#identity-password-new2").val("")}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#identity-delete-dialog").dialog({title:"Delete Profile",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#identity-delete-local-dialog").dialog({title:"Delete Local Data",width:300,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#help-dialog").dialog({title:"Help",width:600,height:400,autoOpen:!1,modal:!1,resizable:!0,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#settings-dialog").dialog({title:"Settings",width:550,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#scripting-dialog").dialog({title:"Link Maker",width:500,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#plantumlserver-dialog").dialog({title:"Change the PlantUML Server",width:500,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#sendtoemail-dialog").dialog({title:"Send Diagram To Email",width:300,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#webhook-dialog").dialog({title:"Send Diagram To Web Hook",width:500,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#intelligence-dialog").dialog({title:"Get PlantUML from OpenAI",width:500,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#chat-dialog").dialog({title:"Chat",width:500,height:400,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){$("#chat-user-input").text(user.firstname)},close:function(){}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#samples-dialog").dialog({title:"Samples",width:650,height:600,minWidth:100,autoOpen:!1,modal:!1,resizable:!0,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){},close:function(){}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#diagram-manager-dialog").dialog({title:"Diagrams",width:500,height:400,minWidth:500,autoOpen:!1,modal:!1,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){},close:function(){}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#file-menu-xport-dialog").dialog({title:"Import / Export",width:450,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#file-menu-new-dialog").dialog({title:"New",width:250,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){},close:function(){$("#file-menu-new-name").val("");$("#file-menu-new-message").text("")}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#file-menu-open-dialog").dialog({title:"Open",width:350,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){submitFileMenuOpenLoad()},close:function(){$("file-menu-open-list").html("");$("#file-menu-open-message").text("")}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#file-menu-saveas-dialog").dialog({title:"Save As...",width:250,autoOpen:!1,modal:!0,resizable:!1,draggable:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},open:function(){},close:function(){$("#file-menu-saveas-name").val("");$("#file-menu-saveas-message").text("")}}).prev(".ui-dialog-titlebar").css("background","#d9d5ff");$("#buttonbar").draggable({handle:"#handle1",containment:"window",scroll:!1});$("#fademessage").draggable({handle:"#handle1",containment:"window",scroll:!1});$("#scratchblock").css("border","0px solid");$("#samples-image").resizable();r=localStorage.getItem("plantuml_diagram");n=localStorage.getItem("planttext_default");r===null&&n===null?(localStorage.setItem("planttext_default","planttext_diagram:Default Diagram"),localStorage.setItem("planttext_diagram:Default Diagram","@startuml\r\rskin rose\r\rBob -> Alice: Hello!\r\r@enduml")):r!=null&&n===null?(localStorage.setItem("planttext_default","planttext_diagram:Default Diagram"),localStorage.setItem("planttext_diagram:Default Diagram",r),localStorage.removeItem("plantuml_diagram")):r===null&&n!=null;typeof Storage!="undefined"&&(f=localStorage.getItem("planttext_message"),f!=null&&(localStorage.setItem("planttext_message",f),localStorage.removeItem("plantuml_diagram")),localStorage.getItem("planttext_layout")===null&&localStorage.setItem("planttext_layout","portrait"),localStorage.getItem("planttext_theme")===null&&localStorage.setItem("planttext_theme","textmate"),localStorage.getItem("planttext_keybinding")===null&&localStorage.setItem("planttext_keybinding","keybinding"),localStorage.getItem("planttext_fontsize")===null&&localStorage.setItem("planttext_fontsize","12"),localStorage.getItem("planttext_usesofttabs")===null&&localStorage.setItem("planttext_usesofttabs",!0),localStorage.getItem("planttext_tabsize")===null&&localStorage.setItem("planttext_tabsize","2"),localStorage.getItem("planttext_invisibles")===null&&localStorage.setItem("planttext_invisibles",!1),localStorage.getItem("planttext_liveautocompletion")===null&&localStorage.setItem("planttext_liveautocompletion",!0),localStorage.getItem("planttext_indentguide")===null&&localStorage.setItem("planttext_indentguide",!0),localStorage.getItem("planttext_highlightactiveline")===null&&localStorage.setItem("planttext_highlightactiveline",!0),localStorage.getItem("planttext_showprintmargin")===null&&localStorage.setItem("planttext_showprintmargin",!0),localStorage.getItem("planttext_showscratch")===null&&localStorage.setItem("planttext_showscratch",!1),localStorage.getItem("planttext_usewrapmode")===null&&localStorage.setItem("planttext_usewrapmode",!1),localStorage.getItem("planttext_snippet")===null&&localStorage.setItem("planttext_snippet",!0),localStorage.getItem("planttext_syntaxhighlight")===null&&localStorage.setItem("planttext_syntaxhighlight",!0),localStorage.getItem("planttext_autorefresh")===null&&localStorage.setItem("planttext_autorefresh",!0),localStorage.getItem("planttext_autoscaleimage")===null&&localStorage.setItem("planttext_autoscaleimage",!0),localStorage.getItem("planttext_plantumlserver")===null&&localStorage.setItem("planttext_plantumlserver","default"));s?(v=decode64(h),refreshFromSamples(v)):typeof Storage!="undefined"?(n=localStorage.getItem("planttext_default"),n==""?editor.getSession().setValue("@startuml\r\rtitle Empty Diagram\r\r@enduml"):n!=null&&(y=localStorage.getItem(n),fileNameOutput(n),editor.getSession().setValue(y)),p=localStorage.getItem("planttext_layout"),p=="landscape"?($("#layout-landscape").attr("checked","checked"),landscape()):($("#layout-portrait").attr("checked","checked"),portrait()),$("#theme option[value='"+localStorage.getItem("planttext_theme")+"']").attr("selected",!0),t=document.getElementById("theme").options[document.getElementById("theme").selectedIndex].value,editor.setTheme("ace/theme/"+t),w=localStorage.getItem("planttext_keybinding"),$("#keybinding option[value='"+w+"']").attr("selected",!0),t=document.getElementById("keybinding").options[document.getElementById("keybinding").selectedIndex].value,editor.setKeyboardHandler("ace/keyboard/"+t),$("#fontsize option[value='"+localStorage.getItem("planttext_fontsize")+"']").attr("selected",!0),t=document.getElementById("fontsize").options[document.getElementById("fontsize").selectedIndex].value,editor.setFontSize(t+"px"),editor.resize(),b=localStorage.getItem("planttext_usesofttabs"),b=="true"?($("#usesofttabs-checkbox").attr("checked","checked"),editor.session.setUseSoftTabs(!0)):($("#usesofttabs-checkbox").removeAttr("checked"),editor.session.setUseSoftTabs(!1)),$("#tabsize-dropdown option[value='"+localStorage.getItem("planttext_tabsize")+"']").attr("selected",!0),t=document.getElementById("tabsize-dropdown").options[document.getElementById("tabsize-dropdown").selectedIndex].value,editor.session.setTabSize(t),editor.resize(),d=localStorage.getItem("planttext_invisibles"),d=="true"?($("#invisibles").attr("checked","checked"),editor.setShowInvisibles(!0)):($("#invisibles").removeAttr("checked"),editor.setShowInvisibles(!1)),g=localStorage.getItem("planttext_liveautocompletion"),g=="true"?($("#liveautocompletion-checkbox").attr("checked","checked"),editor.setOptions({enableLiveAutocompletion:!0})):($("#liveautocompletion-checkbox").removeAttr("checked"),editor.setOptions({enableLiveAutocompletion:!1})),nt=localStorage.getItem("planttext_indentguide"),nt=="true"?($("#indentguide").attr("checked","checked"),editor.setDisplayIndentGuides(!0)):($("#indentguide").removeAttr("checked"),editor.setDisplayIndentGuides(!1)),localStorage.getItem("planttext_highlightactiveline")=="true"?($("#highlightactiveline-checkbox").attr("checked","checked"),editor.setHighlightActiveLine(!0)):($("#highlightactiveline-checkbox").removeAttr("checked"),editor.setHighlightActiveLine(!1)),localStorage.getItem("planttext_showprintmargin")=="true"?($("#showprintmargin-checkbox").attr("checked","checked"),editor.setShowPrintMargin(!0)):($("#showprintmargin-checkbox").removeAttr("checked"),editor.setShowPrintMargin(!1)),tt=localStorage.getItem("planttext_showscratch"),tt=="true"?($("#showscratch-checkbox").attr("checked","checked"),$('textarea[name="scratch-textarea"]').show(),$("#scratchblock").css("border","1px solid"),$("#scratchblock").css("border-color","lightgrey")):($("#showscratch-checkbox").removeAttr("checked"),$('textarea[name="scratch-textarea"]').hide(),$("#scratchblock").css("border","0px solid")),it=localStorage.getItem("planttext_usewrapmode"),it=="true"?($("#usewrapmode-checkbox").attr("checked","checked"),editor.session.setUseWrapMode(!0)):($("#usewrapmode-checkbox").removeAttr("checked"),editor.session.setUseWrapMode(!1)),rt=localStorage.getItem("planttext_snippet"),rt=="true"?($("#snippet-checkbox").attr("checked","checked"),user!=null&&editor.setOptions({enableSnippets:!0})):($("#snippet-checkbox").removeAttr("checked"),user!=null&&editor.setOptions({enableSnippets:!1})),ut=localStorage.getItem("planttext_syntaxhighlight"),ut=="true"?($("#syntaxhighlighting-checkbox").attr("checked","checked"),editor.getSession().setMode("ace/mode/diagram")):($("#syntaxhighlighting-checkbox").removeAttr("checked"),editor.getSession().setMode("ace/mode/text")),ft=localStorage.getItem("planttext_autorefresh"),ft=="true"?($("#autorefresh-checkbox").attr("checked","checked"),autoRefreshStartCount()):($("#autorefresh-checkbox").removeAttr("checked"),autoRefreshStopCount()),et=localStorage.getItem("planttext_autoscaleimage"),et=="true"?($("#autoscaleimage-checkbox").attr("checked","checked"),img.addEventListener("load",resizeImage),resizeImage()):($("#autoscaleimage-checkbox").removeAttr("checked"),img.removeEventListener("load",resizeImage),img.style.width="auto",img.style.height="auto"),e=localStorage.getItem("planttext_plantumlserver"),document.getElementById("plantumlserver").value=e=="default"?"":e,ot=localStorage.getItem("planttext_webhook"),$("#webhook-hook").val(ot),st=localStorage.getItem("planttext_webhooktype"),$("#webhook-imagetype option[value='"+st+"']").attr("selected",!0),document.getElementById("settings-dialog-registered-group").disabled=!0,o=localStorage.getItem("planttext_message"),(o===null||o!=news_version)&&i.trim()==""&&openNewsDialog("planttext_message"),c&&(i=="login"?openLoginDialog():i=="reset"?l&&(resetToken=a,openResetDialog()):i=="register"&&openRegisterDialog())):alert("It appears you do not have a local storage capable browser or configuration. Please resolve before trying to use this application");refreshEditorDirect(!0);LoadSampleCategories();$("#body").show();$("#splash").hide();$("#loader").hide();$("#fademessage").hide()});